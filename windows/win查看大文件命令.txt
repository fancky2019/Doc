Get-ChildItem D:\ -Directory | ForEach-Object { $folder = $_; $size = (Get-ChildItem $folder.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; [PSCustomObject]@{ Name = $folder.Name; SizeGB = [math]::Round($size / 1GB, 2) } } | Sort-Object SizeGB -Descending


Get-ChildItem C:\Users\lirui\Documents -Directory | ForEach-Object { $folder = $_; $size = (Get-ChildItem $folder.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; [PSCustomObject]@{ Name = $folder.Name; SizeGB = [math]::Round($size / 1GB, 2) } } | Sort-Object SizeGB -Descending


Get-ChildItem C:\Users\lirui\Documents\WeChat Files\wxid_wodftypb2llw21\FileStorage -Directory | ForEach-Object { $folder = $_; $size = (Get-ChildItem $folder.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; [PSCustomObject]@{ Name = $folder.Name; SizeGB = [math]::Round($size / 1GB, 2) } } | Sort-Object SizeGB -Descending



D:\  换成具体目录
C:\Users\lirui\Documents
C:\Users\lirui\Documents\WeChat Files\wxid_wodftypb2llw21\FileStorage
C:\Users\lirui\Documents\WeChat Files\wxid_wodftypb2llw21\FileStorage\MsgAttach

C:\Users\lirui\xwechat_files

powershell 管理员身份运行执行命令



微信目录：C:\Users\lirui\xwechat_files\wxid_wodftypb2llw21_90b3\msg\file\2026-01