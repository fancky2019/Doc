Get-ChildItem D:\ -Directory | ForEach-Object { $folder = $_; $size = (Get-ChildItem $folder.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; [PSCustomObject]@{ Name = $folder.Name; SizeGB = [math]::Round($size / 1GB, 2) } } | Sort-Object SizeGB -Descending


Get-ChildItem C:\ -Directory | ForEach-Object { $folder = $_; $size = (Get-ChildItem $folder.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; [PSCustomObject]@{ Name = $folder.Name; SizeGB = [math]::Round($size / 1GB, 2) } } | Sort-Object SizeGB -Descending

D:\  换成具体目录

powershell 管理员身份运行执行命令